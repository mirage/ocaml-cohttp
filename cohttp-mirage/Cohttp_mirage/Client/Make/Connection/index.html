<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Connection (cohttp-mirage.Cohttp_mirage.Client.Make.Connection)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">cohttp-mirage</a> &#x00BB; <a href="../../../index.html">Cohttp_mirage</a> &#x00BB; <a href="../../index.html">Client</a> &#x00BB; <a href="../index.html">Make</a> &#x00BB; Connection</nav><header class="odoc-preamble"><h1>Module <code><span>Make.Connection</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-Net"><a href="#module-Net" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Net/index.html">Net</a></span><span> : <a href="../../../../../cohttp-lwt/Cohttp_lwt/S/module-type-Net/index.html">Cohttp_lwt.S.Net</a></span></code></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Retry"><a href="#exception-Retry" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Retry</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span><span class="optlabel">?finalise</span>:<span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="Net/IO/index.html#type-t">Net.IO.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?persistent</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?ctx</span>:<a href="Net/index.html#type-ctx">Net.ctx</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Net/index.html#type-endp">Net.endp</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>create ?finalise ?persistent ?ctx endp</code> connects to <code>endp</code>. The connection handle may be used immediately, although the connection may not yet be established.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">finalise</span> <p>called when the connection is closed, but before still waiting requests are failed.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">persistent</span> <p>if <code>false</code>, a <code>Connection: close</code> header is sent and the connection closed as soon as possible. If <code>true</code>, it is assumed the remote end does support pipelining and multiple requests may be sent even before receiving any reply. By default we wait for the first response to decide whether connection keep-alive and pipelining is supported. Chunked encoding can only be used when pipelining is supported. Therefore better avoid using chunked encoding on the very first request.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">ctx</span> <p>See <code>Net.ctx</code></p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">endp</span> <p>The remote address, port and protocol to connect to.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-connect"><a href="#val-connect" class="anchor"></a><code><span><span class="keyword">val</span> connect : 
  <span><span class="optlabel">?finalise</span>:<span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="Net/IO/index.html#type-t">Net.IO.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?persistent</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?ctx</span>:<a href="Net/index.html#type-ctx">Net.ctx</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Net/index.html#type-endp">Net.endp</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <a href="Net/IO/index.html#type-t">Net.IO.t</a></span></span></code></div><div class="spec-doc"><p>Same as <code>create</code>, but returns d promise which gets fulfilled when the connection is established or rejected when connecting fails.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-shutdown"><a href="#val-shutdown" class="anchor"></a><code><span><span class="keyword">val</span> shutdown : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Send <em>EOF</em>. On <em>TCP</em> connections send a <em>FIN</em> packet. On <em>TLS</em> connections send a <em>close notify</em>. No new requests can be sent afterwards, but responses may still be received.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close"><a href="#val-close" class="anchor"></a><code><span><span class="keyword">val</span> close : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Immediately close connection. All outstanding requests will fail, but non-idempotent requests that already went out on the wire may have produced side-effects.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_closed"><a href="#val-is_closed" class="anchor"></a><code><span><span class="keyword">val</span> is_closed : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>If <code>is_closed connection</code> is <code>false</code> the <code>connection</code> still accepts new requests.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-length"><a href="#val-length" class="anchor"></a><code><span><span class="keyword">val</span> length : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Number of unfulfilled requests. This includes requests already sent out and requests still waitung to be sent.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-notify"><a href="#val-notify" class="anchor"></a><code><span><span class="keyword">val</span> notify : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="Net/IO/index.html#type-t">Net.IO.t</a></span></span></code></div><div class="spec-doc"><p>Request notification on change of <code>length</code> and on closing.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-call"><a href="#val-call" class="anchor"></a><code><span><span class="keyword">val</span> call : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../../cohttp-lwt/Cohttp_lwt/S/index.html#type-call">Cohttp_lwt.S.call</a></span></code></div><div class="spec-doc"><p>Queue a request. Please see <code>requester</code>.</p></div></div></div></body></html>
